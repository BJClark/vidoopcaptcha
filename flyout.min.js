
jQuery(function(){var $=jQuery;var debug=vidoop_secure.debug;var api_url=vidoop_secure.api_url||'https://api.vidoop.com/';var start_text=vidoop_secure.start_text||'Click here to complete';var start_text_hover=vidoop_secure.start_text_hover||'An image will appear under this field when you click here. This field is required.';var close_text=vidoop_secure.close_text||'Press Escape or Tab to close';var hide_text=vidoop_secure.hide_text||'hide';function add_placeholder(input,placeholder){function onblur(){$.data(this,'maxlength',$(this).attr('maxlength'));if(!this.value||this.value==placeholder){$(this).addClass("vs_placeholder").attr('maxlength',placeholder.length).val(placeholder);}}
$(input).each(onblur).blur(onblur).focus(function(){if($(this).hasClass("vs_placeholder")){$(this).removeClass("vs_placeholder").val('').attr('maxlength',$.data(this,'maxlength'));}});$(input.form).submit(function(){$(this).find('input.vs_placeholder').val('');});}
$.fn.extend({safeattr:function(prop,val){return this.each(function(){if(prop=="maxlength"&&this.getAttribute(prop)>100000||!this.getAttribute(prop))$(this).attr(prop,val);});}});function Captcha($input,captcha_id,instructions){this.small={width:180,height:1};this.anchor=$("<div style='position: relative; clear: both;'></div>").insertAfter($input);this.$slider=$('<div class="vs_bubble"><p>'+get_instructions()+'</p><p class="vs_final_instructions">'+close_text+'</p><div class="vs_hide"><a href="#">'+hide_text+' &times;</a></div>'+'<img src="'+api_url+'vs/captchas/'+captcha_id+'/image"><div class="vs_logo"></div></div>').appendTo(this.anchor).css({opacity:0});var me=this;this.input=$input[0];$(".vidoop_secure .vs_bubble").mousedown(function(e){e.preventDefault();setTimeout(function(){$input.trigger("focus");},0);});$(".vidoop_secure .vs_bubble a").click(function(e){$input[0].blur();e.preventDefault();e.stopPropagation();});$(".vidoop_secure .vs_logo").click(function(e){e.preventDefault();e.stopPropagation();open("http://vidoop.com/captcha/");});var categories=$('.vidoop_secure p').find('b,strong');$input.focus(function(e){$(this).trigger("keydown");me.slide_in(e);}).blur(function(e){if(!debug){me.slide_out(e);}}).bind("keypress keydown",function(e){if(e.keyCode==27){this.blur();}
else{var me=this;setTimeout(function(){var current_letter=Math.min(me.value.length,categories.length);categories.removeClass("vs_current").eq(current_letter).addClass("vs_current");},0);}}).safeattr('title',start_text_hover).safeattr('autocomplete','off').safeattr('maxlength',categories.length);$(".vidoop_secure .vs_bubble img").load(function(){add_placeholder($input[0],start_text+String.fromCharCode(8734));me.$slider.css('display','block');me.large={width:me.$slider.width(),height:me.$slider.height()};me.$slider.css({'display':'none','width':me.small.width,'height':me.small.height});$('<div style="visibility:hidden;position:absolute;height:1px;">x</div>').appendTo(me.anchor).css('top',me.large.height);if(me.focused){$(me.input).trigger("focus");me.slide_in();}
else{me.input.blur();}});}
Captcha.prototype={slide_in:function(e){var me=this;if(this.large){this.$slider.stop().animate({'width':this.large.width,'height':this.large.height,'opacity':1},function(){if(!$.browser.msie||!/^6/.test($.browser.version)){me.$slider[0].scrollIntoView(false);}});}
this.input.focus();this.focused=true;},slide_out:function(e){var me=this;this.$slider.stop().animate({width:this.small.width,height:this.small.height,opacity:'0'},function(){me.$slider.hide();});this.focused=false;},slide_toggle:function(e){if(this.$slider.css('display')=="none"){this.slide_in(e);}
else{this.slide_out(e);}}};function add_style(){$(['<style type="text/css">','.vidoop_secure { position: relative; }','.vidoop_secure .vs_hide { position: absolute; right: 10px; top: 10px; font-size: 12px; }','.vidoop_secure .vs_bubble { text-align: center; padding: 3px 15px; position: absolute; z-index: 999; display: none; background-color: #eee; border: solid 3px #444; margin-bottom: 4px; -moz-border-radius: 5px; -webkit-border-radius: 5px; }','.vidoop_secure p { margin: 10px auto; display: block; width: 500px; font-size: 14px; color: #444; }','.vidoop_secure p b, .vidoop_secure p strong { color: #000; font-size: 16px; }','.vidoop_secure .vs_current { background-color: #ff5; }','.vidoop_secure .vs_final_instructions { line-height: 1; font-size: 10px }','.vidoop_secure img { margin-top: 10px; }','.vidoop_secure .vs_placeholder { color: #00e; text-decoration: underline; }','.vidoop_secure .vs_logo { height: 12px; clear: both; background: url(http://com.vidoop.demo-static.s3.amazonaws.com/images/vidoop_captcha_logo_medium.gif) no-repeat right center; cursor: pointer; }','</style>'].join("\n")).prependTo("head");}
function get_instructions(){return vidoop_secure.instructions;}
add_style();var $input=$('.vidoop_secure input:text');var captcha=new Captcha($input,$('.vidoop_secure input:hidden').val(),get_instructions());$('.vidoop_secure .vs_button').click(function(e){captcha.slide_toggle();});});